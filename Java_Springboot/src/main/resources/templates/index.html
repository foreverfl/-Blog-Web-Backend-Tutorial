<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Hello, Spring Boot!</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body data-logged-in th:attr="data-logged-in=${session.user != null}">
    <h1>Hello, Spring Boot!</h1>

    <hr>

    <div th:if="${session.user != null}">
        <p>아이디: <span th:text="${session.user.username}"></span></p>
        <p>이름: <span th:text="${session.user.name}"></span></p>
        <a th:href="@{/sign_out}"><button>로그아웃</button></a>
    </div>

    <div th:unless="${session.user != null}">
        <p>로그인이 되지 않았습니다.</p>
    </div>

    <hr>

    <a th:href="@{/sign_up}"><button>회원가입</button></a>
    <a th:href="@{/sign_in}"><button>로그인</button></a>
</body>
<script>
    document.addEventListener("DOMContentLoaded", function(){
        const h1Element = document.querySelector("h1");
        const isLoggedIn = document.body.getAttribute('data-logged-in') === 'true';
        
        // hello 이벤트
        h1Element.addEventListener("mouseover", function(){
            h1Element.style.cursor = "pointer";
        });

        h1Element.addEventListener("click", function(){
            window.location.href = "/hello";
        });

        // 로그인 체크
        const signUpButton = document.querySelector('a[href="/sign_up"]');
        const signInButton = document.querySelector('a[href="/sign_in"]');

        if (isLoggedIn) {
            signUpButton.addEventListener("click", function(event) {
                event.preventDefault(); // 기본 이벤트 취소
                alert("이미 로그인이 된 상태입니다.");
            });

            signInButton.addEventListener("click", function(event) {
                event.preventDefault(); // 기본 이벤트 취소
                alert("이미 로그인이 된 상태입니다.");
            });
        }
    });
</script>
</html>
